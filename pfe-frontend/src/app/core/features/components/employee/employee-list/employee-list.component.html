<div class="flex flex-col gap-6 p-6 max-w-7xl mx-auto">
  <!-- Header & Filters -->
  <div class="flex justify-between items-center">
    <h2 class="text-2xl font-semibold">Employee Management</h2>
    <p-button label="Add New Employee" icon="pi pi-plus" [routerLink]="'create'"></p-button>
  </div>

  <div class="flex flex-col md:flex-row gap-4">
    <input pInputText type="text" placeholder="Search employees..." [(ngModel)]="searchTerm" (input)="filterEmployees()" class="w-full md:w-1/2" />
    <p-dropdown 
      [options]="departments" 
      [(ngModel)]="selectedDepartment" 
      placeholder="Select Department"
      (onChange)="filterEmployees()"
      class="w-full md:w-1/4"
    ></p-dropdown>
  </div>

  <!-- Table -->
  <div *ngIf="loading" class="text-center text-gray-600">Loading...</div>
  <p-message *ngIf="error" severity="error" [text]="error"></p-message>

  <p-table *ngIf="!loading && !error" [value]="employees" class="p-datatable-sm">
    <ng-template pTemplate="header">
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Department</th>
        <th>Position</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-employee>
      <tr>
        <td>{{ employee.id }}</td>
        <td>{{ employee.first_name }} {{ employee.last_name }}</td>
        <td>{{ employee.department }}</td>
        <td>{{ employee.position }}</td>
        <td>{{ employee.email || 'No account' }}</td>
        <td>{{ employee.phone }}</td>
        <td class="flex gap-2">
          <p-button icon="pi pi-pencil" label="Edit" class="p-button-sm" (onClick)="onEdit(employee.id!)"></p-button>
          <p-button icon="pi pi-trash" label="Delete" class="p-button-sm p-button-danger" (onClick)="onDelete(employee.id!)"></p-button>
          <p-button icon="pi pi-eye" label="View" class="p-button-sm p-button-secondary" (onClick)="onView(employee)"></p-button>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="7" class="text-center">No employees found</td>
      </tr>
    </ng-template>
  </p-table>

  <!-- Sidebar for details -->
  <p-sidebar [(visible)]="isSidebarOpen" position="right" [dismissible]="true" [baseZIndex]="10000" styleClass="w-full md:w-96">
    <h3 class="text-lg font-semibold mb-4">Employee Details</h3>
    <div *ngIf="selectedEmployee" class="space-y-2">
      <p><strong>ID:</strong> {{ selectedEmployee.id }}</p>
      <p><strong>Name:</strong> {{ selectedEmployee.first_name }} {{ selectedEmployee.last_name }}</p>
      <p><strong>Phone:</strong> {{ selectedEmployee.phone }}</p>
      <p><strong>Department:</strong> {{ selectedEmployee.department_id }}</p>
      <p><strong>Position:</strong> {{ selectedEmployee.position }}</p>
      <p><strong>Hire Date:</strong> {{ selectedEmployee.hire_date }}</p>
      <p><strong>Salary:</strong> ${{ selectedEmployee.salary }}</p>
    </div>
  </p-sidebar>
</div>
