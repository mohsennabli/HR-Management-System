<div class="p-6 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-900 rounded-lg shadow-sm">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-xl font-bold text-blue-900 dark:text-white flex items-center">
      <i class="pi pi-chart-bar mr-2 text-blue-600 dark:text-blue-400"></i>HR Dashboard Overview
    </h2>
    <button pButton 
            icon="pi pi-refresh" 
            class="p-button-rounded p-button-text" 
            (click)="loadStatistics()"
            [disabled]="loading">
    </button>
  </div>

  <p-toast></p-toast>

  <!-- Loading Overlay -->
  <div *ngIf="loading" class="absolute inset-0 bg-white/80 dark:bg-gray-900/80 flex items-center justify-center z-50">
    <div class="flex flex-col items-center">
      <i class="pi pi-spin pi-spinner text-4xl text-blue-600 dark:text-blue-400 mb-2"></i>
      <span class="text-gray-600 dark:text-gray-300">Loading statistics...</span>
    </div>
  </div>

  <!-- Stats Summary Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-5 mb-8">
    <!-- Total Employees Card -->
    <div class="transform transition-all duration-300 hover:scale-105">
      <p-card styleClass="h-64 w-full shadow-md border-t-4 border-blue-500 rounded-lg overflow-hidden">
        <ng-template pTemplate="header">
          <div class="bg-gradient-to-r from-blue-500 to-blue-600 py-2 px-4 text-white text-sm font-medium">
            Employees
          </div>
        </ng-template>
        <ng-template pTemplate="content">
          <div class="flex flex-col items-center justify-center h-full">
            <p-chart type="pie" [data]="employeeChartData" [options]="enhancedChartOptions" class="w-full"></p-chart>
          </div>
        </ng-template>
      </p-card>
    </div>

    <!-- Leave Requests Card -->
    <div class="transform transition-all duration-300 hover:scale-105">
      <p-card styleClass="h-64 w-full shadow-md border-t-4 border-indigo-500 rounded-lg overflow-hidden">
        <ng-template pTemplate="header">
          <div class="bg-gradient-to-r from-indigo-500 to-indigo-600 py-2 px-4 text-white text-sm font-medium">
            Leaves Status
          </div>
        </ng-template>
        <ng-template pTemplate="content">
          <div class="flex flex-col items-center justify-center h-full">
            <p-chart type="doughnut" [data]="leaveChartData" [options]="enhancedChartOptions" class="w-full"></p-chart>
          </div>
        </ng-template>
      </p-card>
    </div>

    <!-- Attendance Rate Card -->
    <div class="transform transition-all duration-300 hover:scale-105">
      <p-card styleClass="h-64 w-full shadow-md border-t-4 border-green-500 rounded-lg overflow-hidden">
        <ng-template pTemplate="header">
          <div class="bg-gradient-to-r from-green-500 to-green-600 py-2 px-4 text-white text-sm font-medium">
            Attendance
          </div>
        </ng-template>
        <ng-template pTemplate="content">
          <div class="flex flex-col items-center justify-center h-full py-4">
            <div class="relative w-32 h-32 mb-2">
              <p-knob 
                [ngModel]="attendanceTrendData?.datasets[0]?.data[attendanceTrendData?.datasets[0]?.data.length - 1] || 0"
                [size]="130" 
                [readonly]="true" 
                [strokeWidth]="10"
                valueColor="#10b981" 
                rangeColor="#e2e8f0">
              </p-knob>
              <div class="absolute inset-0 flex items-center justify-center">
                <span class="text-2xl font-bold text-green-600 dark:text-green-400">
                  {{ attendanceTrendData?.datasets[0]?.data[attendanceTrendData?.datasets[0]?.data.length - 1] || 0 }}%
                </span>
              </div>
            </div>
            <div class="text-sm text-gray-600 dark:text-gray-400 mt-2">Monthly Average</div>
          </div>
        </ng-template>
      </p-card>
    </div>

    <!-- Training Programs Card -->
    <div class="transform transition-all duration-300 hover:scale-105">
      <p-card styleClass="h-64 w-full shadow-md border-t-4 border-purple-500 rounded-lg overflow-hidden">
        <ng-template pTemplate="header">
          <div class="bg-gradient-to-r from-purple-500 to-purple-600 py-2 px-4 text-white text-sm font-medium">
            Training Programs
          </div>
        </ng-template>
        <ng-template pTemplate="content">
          <div class="flex flex-col items-center justify-center h-full">
            <div class="text-4xl font-bold text-purple-600 dark:text-purple-400 mb-2">
              {{ trainingChartData?.datasets[0]?.data?.length || 0 }}
            </div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Active Programs</div>
            <p-chart type="bar" [data]="trainingChartData" [options]="miniBarOptions" class="w-full mt-3"></p-chart>
          </div>
        </ng-template>
      </p-card>
    </div>

    <!-- Disciplinary Actions Card -->
    <div class="transform transition-all duration-300 hover:scale-105">
      <p-card styleClass="h-64 w-full shadow-md border-t-4 border-amber-500 rounded-lg overflow-hidden">
        <ng-template pTemplate="header">
          <div class="bg-gradient-to-r from-amber-500 to-amber-600 py-2 px-4 text-white text-sm font-medium">
            Disciplinary Cases
          </div>
        </ng-template>
        <ng-template pTemplate="content">
          <div class="flex flex-col items-center justify-center h-full">
            <div class="text-4xl font-bold text-amber-600 dark:text-amber-400 mb-2">
              {{ getTotalDisciplinaryCases() }}
            </div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Total Cases</div>
            <div class="w-full mt-3">
              <p-chart type="line" [data]="disciplinaryChartData" [options]="miniLineOptions" class="w-full"></p-chart>
            </div>
          </div>
        </ng-template>
      </p-card>
    </div>

    <!-- Departments Card -->
    <div class="transform transition-all duration-300 hover:scale-105">
      <p-card styleClass="h-64 w-full shadow-md border-t-4 border-cyan-500 rounded-lg overflow-hidden">
        <ng-template pTemplate="header">
          <div class="bg-gradient-to-r from-cyan-500 to-cyan-600 py-2 px-4 text-white text-sm font-medium">
            Departments
          </div>
        </ng-template>
        <ng-template pTemplate="content">
          <div class="flex flex-col items-center justify-center h-full">
            <div class="text-4xl font-bold text-cyan-600 dark:text-cyan-400 mb-2">
              {{ departmentChartData?.labels?.length || 0 }}
            </div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Active Departments</div>
            <div class="w-full mt-3 px-2">
              <p-chart type="radar" [data]="departmentChartData" [options]="radarOptions" class="w-full"></p-chart>
            </div>
          </div>
        </ng-template>
      </p-card>
    </div>
  </div>

  <!-- Additional HR Metrics Section -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <!-- Employee Distribution -->
    <p-card styleClass="shadow-md rounded-lg overflow-hidden">
      <ng-template pTemplate="header">
        <div class="bg-gradient-to-r from-blue-600 to-indigo-600 py-3 px-4">
          <h3 class="text-white font-medium flex items-center">
            <i class="pi pi-users mr-2"></i>Employee Distribution
          </h3>
        </div>
      </ng-template>
      <ng-template pTemplate="content">
        <div class="p-3">
          <p-chart type="bar" [data]="employeeDistributionData" [options]="barChartOptions" height="250px"></p-chart>
        </div>
      </ng-template>
    </p-card>

    <!-- Monthly Attendance Trend -->
    <p-card styleClass="shadow-md rounded-lg overflow-hidden">
      <ng-template pTemplate="header">
        <div class="bg-gradient-to-r from-green-600 to-teal-600 py-3 px-4">
          <h3 class="text-white font-medium flex items-center">
            <i class="pi pi-calendar mr-2"></i>Attendance Trend
          </h3>
        </div>
      </ng-template>
      <ng-template pTemplate="content">
        <div class="p-3">
          <p-chart type="line" [data]="attendanceTrendData" [options]="lineChartOptions" height="250px"></p-chart>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>
